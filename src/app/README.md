# كيفية تشغيل مشروع نظام إدارة الموارد البشرية (HRMS) محليًا

يحتوي هذا الدليل على الإرشادات اللازمة لتثبيت وتشغيل المشروع على جهازك الشخصي (Windows/Linux) أو باستخدام Docker.

## المتطلبات الأساسية

قبل البدء، تأكد من أن لديك الأدوات التالية مثبتة على نظامك:

- **Node.js**: يوصى باستخدام إصدار 18 أو أحدث (`v18.x`, `v20.x`).
- **npm**: مدير الحزم الخاص بـ Node.js (يأتي مدمجًا معه).

## التشغيل المحلي (Windows/Linux)

هذه هي الطريقة المباشرة لتشغيل التطبيق على جهازك.

### 1. تثبيت الاعتماديات (Dependencies)

بعد الحصول على ملفات المشروع، افتح الطرفية (Terminal أو Command Prompt) في المجلد الرئيسي للمشروع وقم بتنفيذ الأمر التالي:

```bash
npm install
```

**ملاحظة هامة:** هذا الأمر سيقوم بتنزيل جميع المكتبات التي يعتمد عليها المشروع، بما في ذلك `better-sqlite3` التي تتطلب بناء بعض الوحدات البرمجية الأصلية (native modules) الخاصة بنظام التشغيل لديك. **هذه الخطوة ضرورية جدًا ولا يمكن تخطيها.**

### 2. تشغيل خادم التطوير

بعد اكتمال التثبيت بنجاح، قم بتشغيل الأمر التالي لبدء خادم التطوير الخاص بـ Next.js:

```bash
npm run dev
```

سيقوم هذا الأمر بتشغيل التطبيق في وضع التطوير على المنفذ (Port) رقم `9002`.

### 3. الوصول إلى التطبيق

الآن، يمكنك فتح متصفح الويب الخاص بك والتوجه إلى العنوان التالي للوصول إلى التطبيق:

[http://localhost:9002](http://localhost:9002)

**ملاحظات حول قاعدة البيانات:**
- يستخدم التطبيق قاعدة بيانات **SQLite**، وهي قاعدة بيانات قائمة على ملف واحد.
- عند تشغيل التطبيق لأول مرة، سيتم إنشاء ملف قاعدة البيانات تلقائيًا باسم `hrms.db` داخل مجلد جديد يسمى `database` في الدليل الرئيسي للمشروع. لا تحتاج إلى أي إعداد يدوي لقاعدة البيانات.

## التشغيل باستخدام Docker (للمستخدمين المتقدمين)

إذا كنت تفضل تشغيل المشروع في بيئة معزولة باستخدام Docker، يمكنك اتباع الخطوات التالية.

### 1. إنشاء ملف `Dockerfile`

في المجلد الرئيسي للمشروع، قم بإنشاء ملف جديد باسم `Dockerfile` (بدون أي امتداد) وأضف المحتوى التالي إليه:

```dockerfile
# 1. مرحلة البناء (Build Stage)
FROM node:20-alpine AS builder
WORKDIR /app

# نسخ ملفات الاعتماديات وتثبيتها
COPY package*.json ./
RUN npm install

# نسخ باقي ملفات المشروع
COPY . .

# بناء التطبيق للإنتاج
RUN npm run build

# 2. مرحلة الإنتاج (Production Stage)
FROM node:20-alpine
WORKDIR /app

# نسخ الاعتماديات المبنية من مرحلة البناء
COPY --from=builder /app/node_modules ./node_modules
# نسخ ملفات Next.js المبنية
COPY --from=builder /app/.next ./.next
COPY --from=builder /app/public ./public
COPY --from=builder /app/package.json .

# تعيين متغير البيئة للإنتاج
ENV NODE_ENV=production

# تعيين المنفذ الذي سيعمل عليه التطبيق
EXPOSE 9002

# الأمر الذي سيتم تنفيذه عند تشغيل الحاوية
CMD ["npm", "start", "--", "-p", "9002"]
```

### 2. بناء صورة Docker

افتح الطرفية في المجلد الرئيسي وقم بتنفيذ الأمر التالي لبناء صورة Docker للتطبيق. استبدل `hrms-app` بالاسم الذي تفضله:

```bash
docker build -t hrms-app .
```

### 3. تشغيل حاوية Docker

بعد بناء الصورة بنجاح، قم بتشغيل حاوية منها باستخدام الأمر التالي:

```bash
docker run -p 9002:9002 hrms-app
```

### 4. الوصول إلى التطبيق

الآن، التطبيق يعمل داخل حاوية Docker ويمكنك الوصول إليه من متصفحك على نفس العنوان:

[http://localhost:9002](http://localhost:9002)

**ملاحظة حول قاعدة البيانات في Docker:**
- في هذا الإعداد، سيتم إنشاء قاعدة بيانات SQLite **داخل الحاوية**. هذا يعني أنها ستُفقد إذا تم حذف الحاوية.
- للحفاظ على البيانات بشكل دائم، يمكنك استخدام **Docker Volumes** عن طريق تعديل أمر التشغيل كالتالي:
  ```bash
  docker run -p 9002:9002 -v $(pwd)/database:/app/database hrms-app
  ```
  هذا الأمر سيقوم بربط مجلد `database` المحلي بمجلد `database` داخل الحاوية، مما يضمن بقاء ملف قاعدة البيانات على جهازك.
